function getNav(){var e=$("ul.main-navigation, ul[role=main-navigation]").before('<fieldset class="mobile-nav">'),t=$("fieldset.mobile-nav").append("<select>");t.find("select").append('<option value="">Navigate&hellip;</option>');var a=function(e,a){location.href==this.href?t.find("select").append('<option value="'+this.href+'" selected>&raquo; '+$(this).text()+"</option>"):t.find("select").append('<option value="'+this.href+'">&raquo; '+$(this).text()+"</option>")};e.find("a").each(a),$("ul.subscription a").each(a),t.find("select").bind("change",function(e){e.target.value&&(window.location.href=e.target.value)})}function addSidebarToggler(){$("body").hasClass("sidebar-footer")||($("#content").append('<span class="toggle-sidebar"></span>'),$(".toggle-sidebar").bind("click",function(e){e.preventDefault(),$("body").toggleClass("collapse-sidebar")}));var e=$("aside.sidebar > section");e.length>1&&e.each(function(t,a){e.length>=3&&t%3===0&&$(a).addClass("first");var i=(t+1)%2?"odd":"even";$(a).addClass(i)}),e.length>=3&&$("aside.sidebar").addClass("thirds")}function testFeatures(){var e=["maskImage"];$(e).map(function(e,t){Modernizr.testAllProps(t)?$("html").addClass(t):$("html").addClass("no-"+t)}),"placeholder"in document.createElement("input")?$("html").addClass("placeholder"):$("html").addClass("no-placeholder")}function addCodeLineNumbers(){"Microsoft Internet Explorer"!==navigator.appName&&$("div.gist-highlight").each(function(e){for(var t='<table><tbody><tr><td class="gutter">',a='<pre class="line-numbers">',i='</pre></td><td class="code">',o="</td></tr></tbody></table>",n=$(".line",e).length,r=1;r<=n;r++)a+='<span class="line-number">'+r+"</span>\n";var s=t+a+i+"<pre>"+$("pre",e).html()+"</pre>"+o;$(e).html(s)})}function flashVideoFallback(){var e="/assets/jwplayer/player.swf",t="/assets/jwplayer/glow/glow.xml";$("video").each(function(a,i){i=$(i),(!Modernizr.video.h264&&swfobject.getFlashPlayerVersion()||window.location.hash.indexOf("flash-test")!==-1)&&(i.children("source[src$=mp4]").first().map(a,function(a){var o=$(a).attr("src"),n="video_"+Math.round(1+1e5*Math.random()),r=i.attr("width"),s=parseInt(i.attr("height"),10)+30;i.after('<div class="flash-video"><div><div id='+n+">"),swfobject.embedSWF(e,n,r,s+30,"9.0.0",{file:o,image:i.attr("poster"),skin:t},{movie:o,wmode:"opaque",allowfullscreen:"true"})}),i.remove())})}function wrapFlashVideos(){$("object").each(function(e,t){$(t).find("param[name=movie]").length&&$(t).wrap('<div class="flash-video">')}),$("iframe[src*=vimeo],iframe[src*=youtube]").wrap('<div class="flash-video">')}function renderDeliciousLinks(e){for(var t="<ul>",a=0,i=e.length;a<i;a++)t+='<li><a href="'+e[a].u+'" title="Tags: '+(""==e[a].t?"":e[a].t.join(", "))+'">'+e[a].d+"</a></li>";t+="</ul>",$("#delicious").html(t)}function html_decode(e){var t="";return 0==e.length?"":(t=e.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'),t=t.replace(/<br\/>/g,"\n"))}function highlight(){var e=$("figure"),t='<div class="widget-codetool" style="display:none;"><button class="copyCode btn btn-xs" data-clipboard-text="" title="">复制</button></div>',a='<div class="tooltip fade top in" role="tooltip"><div class="tooltip-inner">已复制</div></div>';e.each(function(e,a){var i=$(t);i.find(".copyCode").attr("data-clipboard-text",html_decode($(this).find(".code pre").html().replace(/<br>/g,"\n").replace(/<.+?>/g,""))),$(this).before(i),$(this).removeAttr("data-source-code"),$(this).attr("data-id",e)});var i=new Clipboard(".copyCode");i.on("success",function(e){$("body").append(a);var t=$(event.target).parent().next();$(".tooltip").css({top:t.offset().top+"px",left:t.offset().left-$("body").offset().left+t.width()/2-18+"px"}),$(".tooltip").slideDown(),setTimeout(function(){$(".tooltip").slideUp(function(){$(this).remove()})},900),e.clearSelection()}),i.on("error",function(e){console.error("Action:",e.action),console.error("Trigger:",e.trigger)}),e.mouseenter(function(e){clearTimeout(window["copyTimer"+$(this).attr("data-id")]),$(this).prev().fadeIn()}),$(".widget-codetool").mousedown(function(e){}),$(".widget-codetool").mouseenter(function(e){clearTimeout(window["copyTimer"+$(this).next().attr("data-id")])}),$(".widget-codetool").mouseleave(function(e){var t=this;window["copyTimer"+$(this).next().attr("data-id")]=setTimeout(function(){$(t).fadeOut(function(){})},1800)}),e.mouseleave(function(e){var t=this;window["copyTimer"+$(this).attr("data-id")]=setTimeout(function(){$(t).prev().fadeOut()},1800)})}function fancybox(){$("article").each(function(e){$(this).find("img").each(function(){if(!$(this).parent().hasClass("fancybox")){var e=this.alt;$(this).wrap('<a href="'+this.src+'" title="'+e+'" class="fancybox"></a>')}}),$(this).find(".fancybox").each(function(){$(this).attr("rel","article"+e)})}),$.fancybox&&$(".fancybox").fancybox()}$("document").ready(function(){testFeatures(),wrapFlashVideos(),flashVideoFallback(),getNav(),addSidebarToggler(),highlight(),fancybox()}),function(e){function t(){r.content="width=device-width,minimum-scale="+n[0]+",maximum-scale="+n[1],e.removeEventListener(i,t,!0)}var a="addEventListener",i="gesturestart",o="querySelectorAll",n=[1,1],r=o in e?e[o]("meta[name=viewport]"):[];(r=r[r.length-1])&&a in e&&(t(),n=[.25,1.6],e[a](i,t,!0))}(document);var swfobject=function(){function e(e,a,i){var s,c=t(i);if(d.wk&&d.wk<312)return s;if(c)if(typeof e.id==o&&(e.id=i),d.ie&&d.win){var f,p="";for(f in e)e[f]!=Object.prototype[f]&&("data"==f.toLowerCase()?a.movie=e[f]:"styleclass"==f.toLowerCase()?p+=' class="'+e[f]+'"':"classid"!=f.toLowerCase()&&(p+=" "+f+'="'+e[f]+'"'));f="";for(var u in a)a[u]!=Object.prototype[u]&&(f+='<param name="'+u+'" value="'+a[u]+'" />');c.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+p+">"+f+"</object>",s=t(e.id)}else{u=l.createElement(n),u.setAttribute("type",r);for(var h in e)e[h]!=Object.prototype[h]&&("styleclass"==h.toLowerCase()?u.setAttribute("class",e[h]):"classid"!=h.toLowerCase()&&u.setAttribute(h,e[h]));for(p in a)a[p]!=Object.prototype[p]&&"movie"!=p.toLowerCase()&&(e=u,f=p,h=a[p],i=l.createElement("param"),i.setAttribute("name",f),i.setAttribute("value",h),e.appendChild(i));c.parentNode.replaceChild(u,c),s=u}return s}function t(e){var t=null;try{t=l.getElementById(e)}catch(e){}return t}function a(e){var t=d.pv,e=e.split(".");return e[0]=parseInt(e[0],10),e[1]=parseInt(e[1],10)||0,e[2]=parseInt(e[2],10)||0,t[0]>e[0]||t[0]==e[0]&&t[1]>e[1]||t[0]==e[0]&&t[1]==e[1]&&t[2]>=e[2]}function i(e){return null!=/[\\\"<>\.;]/.exec(e)&&typeof encodeURIComponent!=o?encodeURIComponent(e):e}var o="undefined",n="object",r="application/x-shockwave-flash",s=window,l=document,c=navigator,d=function(){var e=typeof l.getElementById!=o&&typeof l.getElementsByTagName!=o&&typeof l.createElement!=o,t=c.userAgent.toLowerCase(),a=c.platform.toLowerCase(),i=a?/win/.test(a):/win/.test(t),a=a?/mac/.test(a):/mac/.test(t),t=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),d=!1,f=[0,0,0],p=null;if(typeof c.plugins!=o&&typeof c.plugins["Shockwave Flash"]==n)!(p=c.plugins["Shockwave Flash"].description)||typeof c.mimeTypes!=o&&c.mimeTypes[r]&&!c.mimeTypes[r].enabledPlugin||(d=!1,p=p.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(p.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(p.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(p)?parseInt(p.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof s.ActiveXObject!=o)try{var u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");u&&(p=u.GetVariable("$version"))&&(d=!0,p=p.split(" ")[1].split(","),f=[parseInt(p[0],10),parseInt(p[1],10),parseInt(p[2],10)])}catch(e){}return{w3:e,pv:f,wk:t,ie:d,win:i,mac:a}}();return{embedSWF:function(t,i,r,s,l,c,f,p,u){var h={success:!1,id:i};if(d.w3&&!(d.wk&&d.wk<312)&&t&&i&&r&&s&&l){r+="",s+="";var v={};if(p&&typeof p===n)for(var m in p)v[m]=p[m];if(v.data=t,v.width=r,v.height=s,t={},f&&typeof f===n)for(var g in f)t[g]=f[g];if(c&&typeof c===n)for(var $ in c)typeof t.flashvars!=o?t.flashvars+="&"+$+"="+c[$]:t.flashvars=$+"="+c[$];a(l)&&(i=e(v,t,i),h.success=!0,h.ref=i)}u&&u(h)},ua:d,getFlashPlayerVersion:function(){return{major:d.pv[0],minor:d.pv[1],release:d.pv[2]}},hasFlashPlayerVersion:a,createSWF:function(t,a,i){if(d.w3)return e(t,a,i)},getQueryParamValue:function(e){var t=l.location.search||l.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return i(t);for(var t=t.split("&"),a=0;a<t.length;a++)if(t[a].substring(0,t[a].indexOf("="))==e)return i(t[a].substring(t[a].indexOf("=")+1))}return""}}}();